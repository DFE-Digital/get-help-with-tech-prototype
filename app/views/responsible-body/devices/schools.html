{% extends "layout.html" %}
{% switch data['who-orders-laptops'] %}
  {% case 'schools' %}
    {% set title = "Give us contact details for each school" %}
    {% set description = "Schools will manage their own orders" %}
    {% set devolvedAll = true %}
  {% case 'central' %}
    {% set title = "Schools you’ll need to order devices for" %}
    {% set description = "All device orders are managed centrally" %}
    {% set centralAll = true %}
  {% default %}
    {% set title = "Tell us who will manage orders for each school" %}
    {% set description = "Some schools will manage their own orders" %}
    {% set someSchools = true %}
{% endswitch %}

{% set title = "Schools that will need devices" %}

{% block pageTitle %}{{ title }}{% endblock %}

{% block pageNavigation %}
  {{ govukBreadcrumbs({
    items: [
      {
        text: "Get help with technology",
        href: "/responsible-body"
      },
      {
        text: "Get devices"
      }
    ]
  }) }}
{% endblock %}

{% block content %}
<h1 class="govuk-heading-xl">
  <span class="govuk-caption-xl">Get devices</span>
  {{ title }}
</h1>

<h2 class="govuk-heading-l">{{ data.schools.length }} schools</h2>

<div data-module="filterable-table">
  <form class="app-filter-container">
    <div class="govuk-form-group govuk-!-margin-top-1 govuk-!-margin-bottom-4">
      <label class="govuk-label govuk-label--s" for="filter">
        Filter the list of schools
      </label>
      <div id="account-number-hint" class="govuk-hint">
        Try searching for “Secondary” or a status like “Needs a contact”
      </div>
      <input class="govuk-input js-filter-table-input" id="filter" name="filter" type="text">
    </div>
  </form>

  <table class="govuk-table">
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th class="govuk-table__header" style="width: 50%">School</th>
        <th class="govuk-table__header">Allocation</th>
        <th class="govuk-table__header">Who orders?</th>
        <th class="govuk-table__header" style="width: 200px">Status</th>
      </tr>
    </thead>
    <tbody class="govuk-table__body">
      {% for school in data.schools %}
        <tr class="govuk-table__row">
          <td class="govuk-table__cell">
            <a href="/responsible-body/devices/schools/{{ school.URN }}" class="js-open-on-submit">{{ school.name }}</a><br />
            {% if school.type == 'Special schools' %}
              Special school
            {% else %}
              {{ school.phase }}
            {% endif %}
          </td>
          <td class="govuk-table__cell">
            {{ school.total }}
          </td>
          <td class="govuk-table__cell">
            {% if data['responsible-body'][school.URN] %}
              {% if data['responsible-body'][school.URN].who == 'central' %}
                Local authority
              {% else %}
                School
              {% endif %}
            {% elseif centralAll %}
              Local authority
            {% elseif devolvedAll %}
              School
            {% else %}
              Unknown
            {% endif %}
          </td>
          <td class="govuk-table__cell">
            {% if data['responsible-body'][school.URN] %}
              {% if data['responsible-body'][school.URN].who == 'central' %}
                <span class="govuk-tag govuk-tag--completed">Ready</span>
              {% else %}
                <span class="govuk-tag govuk-tag--yellow">School contacted</span>
              {% endif %}
              <!-- <span class="govuk-tag govuk-tag--yellow">School contacted</span>
              <span class="govuk-tag govuk-tag--blue">School signed in</span>
              <span class="govuk-tag govuk-tag--completed">School ready</span> -->
            {% else %}
              {% if centralAll %}
                <span class="govuk-tag govuk-tag--grey">Needs information</span>
              {% else %}
                <span class="govuk-tag govuk-tag--grey">Needs a contact</span>
              {% endif %}
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
