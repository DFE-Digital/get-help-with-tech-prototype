{% extends "layout.html" %}
{% set title = school.name %}
{% block pageTitle %}{{ title }}{% endblock %}

{% block pageNavigation %}
  {{ govukBackLink({
    href: "/responsible-body/devices/schools"
  }) }}
{% endblock %}

{% set schoolContactHtml %}
  {% if isHeadteacher %}Headteacher: {% endif %}
  {{ name }}
  <br />{{ emailAddress }}
  {% if number %}
    <br />{{ number }}
  {% endif %}
{% endset %}

{% set statusHtml %}
  {% set urn = school.URN %}
  {% include 'responsible-body/devices/school/_status-tag.html' %}
{% endset %}

{% block content %}
{{ appBanner({
  html: '<h2 class="govuk-heading-m">' + success + '</h2>',
  type: "success",
  icon: false
}) if success }}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">
      {{ title }}
    </h1>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <form action="/responsible-body/devices/schools/{{ school.URN }}" method="post">
      <!-- <h2 class="govuk-heading-l">School details</h2> -->
      <div class="govuk-!-margin-bottom-6 govuk-!-padding-top-0">
        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-0 govuk-!-margin-top-0',
          rows: [
            {
              key: {
                text: "Status"
              },
              value: {
                html: statusHtml
              }
            },
            {
              key: {
                text: "Provisional allocation"
              },
              value: {
                text: school.total + ' devices'
              },
              actions: {
                items: [
                  {
                    href: "#",
                    text: "Query",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            },
            {
              key: {
                text: "Type of school"
              },
              value: {
                text: "Special school" if school.type == 'Special schools' else school.phase + ' school'
              }
            },
            {
              key: {
                text: "Who will order?"
              },
              value: {
                text: whoOrders
              },
              actions: {
                items: [
                  {
                    href: "/responsible-body/devices/schools/" + school.URN + "/who",
                    text: "Change",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            },
            {
              key: {
                text: "School contact"
              },
              value: {
                html: schoolContactHtml
              },
              actions: {
                items: [
                  {
                    href: "/responsible-body/devices/schools/" + school.URN + "/who-contact",
                    text: "Change",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            } if hasSetContactDetails,
            {
              key: {
                text: "Ordering Chromebooks?"
              },
              value: {
                text: data["responsible-body"][school.URN].chromebooks
              },
              actions: {
                items: [
                  {
                    href: "/responsible-body/devices/schools/" + school.URN + "/chromebooks",
                    text: "Change",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            } if hasSetChromebookDetails,
            {
              key: {
                text: "Domain"
              },
              value: {
                text: domain
              },
              actions: {
                items: [
                  {
                    href: "/responsible-body/devices/schools/" + school.URN + "/chromebooks",
                    text: "Change",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            } if domain,
            {
              key: {
                text: "Recovery email address"
              },
              value: {
                text: recoveryAddress
              },
              actions: {
                items: [
                  {
                    href: "/responsible-body/devices/schools/" + school.URN + "/chromebooks",
                    text: "Change",
                    visuallyHiddenText: "name"
                  }
                ]
              }
            } if recoveryAddress
          ]
        }) }}
      </div>

      {% if showContactForm %}
        {% include 'responsible-body/devices/school/_contact-details.html' %}

        {{ govukButton({
          text: "Save and send email"
        }) }}
      {% endif %}

      {% if showChromebookForm %}
        <h2 class="govuk-heading-l">Will the school need Chromebooks?</h2>
        {% include 'responsible-body/devices/school/_chromebook-details.html' %}

        {{ govukButton({
          text: "Save"
        }) }}
      {% endif %}

      <p>
        <a href="/responsible-body/devices/schools">Return to list of schools</a> or <a href="/responsible-body/devices/schools/{{ nextSchoolUrn }}">go to the next school</a>
      </p>
    </form>
  </div>
  <div class="govuk-grid-column-one-third">
    <!-- <div class="app-related" style="background-color: #f3f2f1; padding-left: 15px; padding-right: 15px; padding-bottom: 10px">
      <h2 class="govuk-heading-m">Guidance</h2>
      <ul class="govuk-list">
        <li><a href="#">Query an allocation</a></li>
        <li><a href="#">Request devices for shielding children</a></li>
      </ul>
    </div> -->
  </div>
</div>
{% endblock %}
